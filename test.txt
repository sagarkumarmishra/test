import requests

DATAHUB_URL = "https://dhub-ui-int.cta.allianz/actuator/health"

try:
    response = requests.get(DATAHUB_URL, timeout=10)
    print("Connected successfully")
    print("Status Code:", response.status_code)
    print("Response:", response.text)
except Exception as e:
    print("Connection failed")
    print(e)
Here‚Äôs a **very short and clean** version you can use üëá

> Tested ADP ‚Üí DataHub from Azure Synapse INT.
> Browser access works, but Synapse fails with **DNS resolution error**, indicating a network/DNS restriction.
> Network access from Synapse INT to DataHub INT is required to proceed.


MariaXavier.Mariappan@bs.nttdata.com

10147514


The employee is involved in data processing, system integration, and analytics-related activities, supporting business operations through ETL processes, reporting, and technology-driven insights.



import requests

url = "https://dhub-ui-int.cta.allianz/api/your-endpoint"

headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer <TOKEN>"
}

payload = {
    "portfolioId": "123",
    "data": "test"
}

response = requests.post(url, json=payload, headers=headers, timeout=30)

print(response.status_code)
print(response.text)




import requests

try:
    response = requests.get("https://www.google.com", timeout=10)
    print("Public internet WORKS! Status:", response.status_code)
    print("Snippet:", response.text[:200])
except Exception as e:
    print("Public outbound also fails:", str(e))





import requests

url = "https://dhub-ui-int.cta.allianz/actuator/health"

response = requests.get(url, timeout=30)

print("Status code:", response.status_code)
print("Response:", response.text)





import requests

url = "https://dhub-ui-int.cta.allianz/api/v1/ingestion"

headers = {
    "Authorization": "Bearer <ACCESS_TOKEN>",
    "Content-Type": "application/json"
}

payload = {
    "source": "synapse",
    "dataset": "test",
    "records": 1
}

response = requests.post(url, headers=headers, json=payload)

print(response.status_code)
print(response.text)



import socket

try:
    print(socket.gethostbyname("dhub-ui-int.cta.allianz"))
except Exception as e:
    print("DNS failed:", e)



import requests

url = "https://dhub-int.cta.allianz/api/v1/ingestion"

headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer <YOUR_TOKEN_IF_REQUIRED>"
}

payload = {
    "message": "hello from synapse python"
}

response = requests.post(
    url,
    json=payload,
    headers=headers,
    timeout=30
)

print("Status code:", response.status_code)
print("Response:", response.text)




import socket
socket.gethostbyname("dhub-int.cta.allianz")




import requests
import socket

URL = "https://dhub-int.cta.allianz/actuator/health"

print("Testing DNS resolution...")
try:
    print("IP:", socket.gethostbyname("dhub-int.cta.allianz"))
except Exception as e:
    print("‚ùå DNS FAILED:", e)

print("\nCalling DataHub API...")
try:
    r = requests.get(URL, timeout=10)
    print("‚úÖ Connected")
    print("Status Code:", r.status_code)
    print("Response:", r.text)
except Exception as e:
    print("‚ùå API Call Failed")
    print(e)


"C:\Program Files\Python314\python.exe" -m pip install requests

"C:\Program Files\Python314\python.exe" -m ensurepip --upgrade

py "C:\Users\esit6ay\OneDrive - Allianz\Desktop\test.py"


"C:\Program Files\Python314\python.exe" -c "import requests; print(requests.__version__)"




# Name: SAGAR KUMAR MISHRA - 2024DC04006 - 40%
# Name: ROHITH CHOWDHARY TURLAPATI - 2024AC05851 - 30%
# Name: SABIKA QIZILBASH . - 2024DC04267 - 30%



Yes, **it is possible** to define parameters inside your REST linked service named **Datahub** (even with **Anonymous** authentication), and then use dynamic values at runtime ‚Äî including making the base URL (or parts of it) dynamic.

This feature exists in both Azure Data Factory and Azure Synapse Analytics (they share the same engine). Parameterizing a linked service is especially useful for:

- Switching environments (e.g., dev/test/prod URLs)
- Using different base paths or subdomains
- Passing values from pipeline parameters

Since your authentication is **Anonymous** (no credentials needed), it's straightforward ‚Äî no secrets involved.

### Step-by-step: How to add parameters to your REST linked service

1. Go to **Manage** tab ‚Üí **Linked services** ‚Üí edit your linked service named **Datahub**.

2. In the edit screen:
   - Scroll down or look for **Parameters** section (sometimes under "Advanced").
   - Click **+ New** to add parameters.
   - Example: Add a parameter named `BaseUrl` (type: String)
     - Default value (optional): `https://dhub-int.cta.allianz` (so it works without changes initially)

3. In the **Base URL** field (currently probably hardcoded as `https://dhub-int.cta.allianz`):
   - Switch to dynamic content mode (click "Add dynamic content" or the {} icon).
   - Enter: `@{linkedService().BaseUrl}`
     - This references the parameter you just created.

4. **Save** the linked service.
   - Test connection should still work if you kept the default value.

**Alternative (JSON mode ‚Äì more reliable if UI is glitchy):**
- In the linked service edit screen ‚Üí expand **Advanced** at bottom ‚Üí check **Specify dynamic contents in JSON format**.
- Edit the JSON directly. Example full payload:

```json
{
  "name": "Datahub",
  "properties": {
    "type": "RestService",
    "typeProperties": {
      "url": "@{linkedService().BaseUrl}",
      "enableServerCertificateValidation": true,  // or false if self-signed cert issues
      "authenticationType": "Anonymous"
    },
    "parameters": {
      "BaseUrl": {
        "type": "String",
        "defaultValue": "https://dhub-int.cta.allianz"
      }
    }
  }
}
```

- Save and test connection.

### How this helps you connect / use it

- **Base URL becomes dynamic** ‚Üí you can pass different values at runtime (e.g., from pipeline parameters).
- In a **dataset** (REST type) using this linked service:
  - Add a parameter like `RelativePath` (String)
  - In dataset ‚Üí Relative URL: `@{dataset().RelativePath}`

- In a **Copy activity**, **Lookup**, or **Web activity**:
  - Pass values when running the pipeline:
    - Pipeline parameter: `pBaseUrl` = `https://dhub-int.cta.allianz`
    - In activity ‚Üí linked service parameters ‚Üí `BaseUrl` = `@pipeline().parameters.pBaseUrl`

- For PySpark notebook usage (limited direct support):
  - You cannot directly pass linked service parameters from notebook code.
  - But you can use the linked service in **Copy/Lookup/Web activity** inside a pipeline, then trigger the pipeline from notebook (via `mssparkutils.notebook.run()` or pipeline run API) ‚Üí pass parameters there.

### Example use cases with your URL

| Scenario | Parameter setup | Value passed at runtime | Resulting full URL |
|----------|-----------------|--------------------------|---------------------|
| Fixed URL | `BaseUrl` = `https://dhub-int.cta.allianz` | (default) | `https://dhub-int.cta.allianz` |
| Different env | `BaseUrl` + `Env` param | `Env` = `tst` | `https://dhub-tst.cta.allianz` (if you concat in expression) |
| Add path | Keep base fixed, use dataset `RelativeUrl` | `/actuator/health` | `https://dhub-int.cta.allianz/actuator/health` |

### Quick test in UI

- After parameterizing ‚Üí create a simple **Web activity** in a pipeline.
- Use your linked service **Datahub**.
- In Web activity URL: leave blank or put relative path only (e.g. `/actuator/health`).
- Pipeline parameter ‚Üí pass `BaseUrl` if needed.
- Debug/run ‚Üí see if it hits the endpoint successfully.

If you run into issues (e.g. "Invalid URL", connection fail, or UI not showing parameters), reply with:
- Screenshot/error message
- Current JSON of the linked service (copy from Advanced JSON view)

Then I can give exact fixes or expressions. This should resolve your connectivity goal using the approved linked service path! üöÄ