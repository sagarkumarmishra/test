import requests

DATAHUB_URL = "https://dhub-ui-int.cta.allianz/actuator/health"

try:
    response = requests.get(DATAHUB_URL, timeout=10)
    print("Connected successfully")
    print("Status Code:", response.status_code)
    print("Response:", response.text)
except Exception as e:
    print("Connection failed")
    print(e)
Here‚Äôs a **very short and clean** version you can use üëá

> Tested ADP ‚Üí DataHub from Azure Synapse INT.
> Browser access works, but Synapse fails with **DNS resolution error**, indicating a network/DNS restriction.
> Network access from Synapse INT to DataHub INT is required to proceed.


MariaXavier.Mariappan@bs.nttdata.com

10147514


The employee is involved in data processing, system integration, and analytics-related activities, supporting business operations through ETL processes, reporting, and technology-driven insights.



import requests

url = "https://dhub-ui-int.cta.allianz/api/your-endpoint"

headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer <TOKEN>"
}

payload = {
    "portfolioId": "123",
    "data": "test"
}

response = requests.post(url, json=payload, headers=headers, timeout=30)

print(response.status_code)
print(response.text)




import requests

try:
    response = requests.get("https://www.google.com", timeout=10)
    print("Public internet WORKS! Status:", response.status_code)
    print("Snippet:", response.text[:200])
except Exception as e:
    print("Public outbound also fails:", str(e))





import requests

url = "https://dhub-ui-int.cta.allianz/actuator/health"

response = requests.get(url, timeout=30)

print("Status code:", response.status_code)
print("Response:", response.text)





import requests

url = "https://dhub-ui-int.cta.allianz/api/v1/ingestion"

headers = {
    "Authorization": "Bearer <ACCESS_TOKEN>",
    "Content-Type": "application/json"
}

payload = {
    "source": "synapse",
    "dataset": "test",
    "records": 1
}

response = requests.post(url, headers=headers, json=payload)

print(response.status_code)
print(response.text)



import socket

try:
    print(socket.gethostbyname("dhub-ui-int.cta.allianz"))
except Exception as e:
    print("DNS failed:", e)



import requests

url = "https://dhub-int.cta.allianz/api/v1/ingestion"

headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer <YOUR_TOKEN_IF_REQUIRED>"
}

payload = {
    "message": "hello from synapse python"
}

response = requests.post(
    url,
    json=payload,
    headers=headers,
    timeout=30
)

print("Status code:", response.status_code)
print("Response:", response.text)




import socket
socket.gethostbyname("dhub-int.cta.allianz")




import requests
import socket

URL = "https://dhub-int.cta.allianz/actuator/health"

print("Testing DNS resolution...")
try:
    print("IP:", socket.gethostbyname("dhub-int.cta.allianz"))
except Exception as e:
    print("‚ùå DNS FAILED:", e)

print("\nCalling DataHub API...")
try:
    r = requests.get(URL, timeout=10)
    print("‚úÖ Connected")
    print("Status Code:", r.status_code)
    print("Response:", r.text)
except Exception as e:
    print("‚ùå API Call Failed")
    print(e)


"C:\Program Files\Python314\python.exe" -m pip install requests

"C:\Program Files\Python314\python.exe" -m ensurepip --upgrade

py "C:\Users\esit6ay\OneDrive - Allianz\Desktop\test.py"


"C:\Program Files\Python314\python.exe" -c "import requests; print(requests.__version__)"




# Name: SAGAR KUMAR MISHRA - 2024DC04006 - 40%
# Name: ROHITH CHOWDHARY TURLAPATI - 2024AC05851 - 30%
# Name: SABIKA QIZILBASH . - 2024DC04267 - 30%



Yes, Sagar ‚Äî you **can** add parameters to your REST linked service named **Datahub** (even with **Anonymous** authentication and **Self-hosted Integration Runtime** selected). This allows making the **Base URL** dynamic (or parts of it), which is useful for switching environments, adding paths dynamically, or future-proofing.

However, from your screenshot, the **Parameters** section is collapsed/empty in the UI, and the **Base URL** field doesn't show a direct "Add dynamic content" button like some other connectors. This is common for REST linked services ‚Äî the UI support for parameters is limited or hidden, so you need the **Advanced JSON mode** to add them reliably.

Follow these exact **step-by-step instructions** (baby steps, do one at a time):

### Step 1: Open the edit screen again (you're already there)
- You're in **Edit linked service** for **Datahub**.
- Keep everything as-is for now (Self-hosted IR selected, Anonymous, Enable certificate validation checked, Base URL = `https://dhub-int.cta.allianz`).

### Step 2: Switch to Advanced JSON mode to add parameters
1. Scroll to the very bottom of the edit screen.
2. Expand the **Advanced** section (it might say **Advanced** with a little arrow ‚ñº or ‚ñ∂).
3. Check the box: **Specify dynamic contents in JSON format** (this is crucial ‚Äî it unlocks full JSON editing).
   - Once checked, the UI will show a big JSON editor box with the current definition of your linked service.

### Step 3: Edit the JSON to add a parameter and make Base URL dynamic
Replace the content in the JSON box with this updated version (copy-paste carefully):

```json
{
  "name": "Datahub",
  "properties": {
    "type": "RestService",
    "typeProperties": {
      "url": "@{linkedService().BaseUrl}",
      "enableServerCertificateValidation": true,
      "authenticationType": "Anonymous"
    },
    "connectVia": {
      "referenceName": "SelfHostedIntegrationRuntime",
      "type": "IntegrationRuntimeReference"
    },
    "parameters": {
      "BaseUrl": {
        "type": "String",
        "defaultValue": "https://dhub-int.cta.allianz"
      }
    }
  }
}
```

- Key changes explained:
  - Added `"parameters"` section with `BaseUrl` (String type + default value so it works immediately).
  - Changed `"url"` to `"@{linkedService().BaseUrl}"` ‚Äî this references the new parameter dynamically.
  - Kept your Self-hosted IR reference and Anonymous auth.
  - `enableServerCertificateValidation`: true (matches your UI choice; change to false only if you have cert trust issues during testing).

**Important notes**:
- The `referenceName` under `connectVia` must exactly match your Self-hosted IR name (you have "SelfHostedIntegrationRuntime" ‚Äî confirm it matches exactly; if it's different like "SHIR-Allianz-Prod", update it).
- Indentation must be correct (JSON is picky).

### Step 4: Save and Test connection
1. Click **Save** at the bottom.
2. Wait a moment ‚Üí then click **Test connection** (the blue button).
   - It should succeed (green check) because the default value is your current URL.
   - If it fails:
     - "Invalid URI" or parsing error ‚Üí double-check the JSON syntax (no extra commas, quotes correct).
     - Connection error ‚Üí temporarily set `"enableServerCertificateValidation": false` in JSON, save & re-test (self-signed/internal cert issue?).
     - IR-related ‚Üí confirm your Self-hosted IR is online/running in **Manage ‚Üí Integration runtimes**.

### Step 5: Use the parameter in practice (e.g., in a dataset or activity)
Once saved:
- Create/edit a **REST dataset** using this linked service.
  - In the dataset ‚Üí **Relative URL** (or path) can be dynamic (e.g., `/actuator/health`).
  - Full call = Base URL (from linked service param) + Relative URL.
- In a **pipeline**:
  - Add **Web activity** or **Copy activity** (with REST source).
  - In the activity settings ‚Üí Linked service parameters section ‚Üí set `BaseUrl` dynamically, e.g.:
    - `@pipeline().parameters.MyEnvUrl` (if you create a pipeline parameter)
    - Or hardcode for test: `https://dhub-int.cta.allianz`
- For notebook/PySpark: You can't pass linked service parameters directly from code, but you can trigger a pipeline (with params) using `mssparkutils.pipeline.run()`.

### Step 6: Verify everything works
- After saving ‚Üí go back to **Develop** tab.
- Create a simple **Web activity** in a new pipeline:
  - Use linked service **Datahub**.
  - Set URL (if needed): `/actuator/health` (relative).
  - Method: GET.
  - Debug/run the pipeline ‚Üí check output for 200 OK + response body (e.g., {"status":"UP"}).
- If successful ‚Üí your linked service is parameterized and connected via Self-hosted IR!

### Common issues & fixes
- **Parameters section still not visible after save?** ‚Üí Normal in REST UI; it only shows in JSON mode. You don't need the collapsed Parameters accordion anymore.
- **Test connection fails after JSON change?** ‚Üí Revert to your original non-dynamic JSON temporarily to confirm, then fix syntax.
- **Want more parameters?** ‚Üí Add to the `"parameters"` object, e.g. `"ApiPath": { "type": "String", "defaultValue": "/actuator" }`, then use in URL like `"url": "@{concat(linkedService().BaseUrl, linkedService().ApiPath, '/health')}"`.

Do these steps now, and reply with:
- Did **Test connection** succeed after JSON save?
- Any error message (exact text)?
- If you want to add more params (e.g. for path or env), tell me.

You're very close ‚Äî this should unlock dynamic connectivity! üöÄ